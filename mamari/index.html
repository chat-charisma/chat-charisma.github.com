<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>無限スクロールの例</title>

<script>
// ===========================================
// ここからHEADタグ
// ===========================================

 var googletag = googletag || {};
 googletag.cmd = googletag.cmd || [];
 (function(){
   var gads = document.createElement('script');
   gads.async = true;
   var useSSL = 'https:' == document.location.protocol;
   gads.src = (useSSL ? 'https:' : 'http:') +
       '//www.googletagservices.com/tag/js/gpt.js';
   var node = document.getElementsByTagName('script')[0];
   node.parentNode.insertBefore(gads, node);
   })();
</script>

<script>

googletag.cmd.push(function() {

  googletag.defineSlot('/62532913/s_mamari_320x100_kijisita_9999', [320, 100], 'kijisita_0').
  addService(googletag.pubads());

  googletag.defineSlot('/62532913/s_mamari_300x250_middle1starticle_9999', [300, 250], 'middle_1st_0').
  addService(googletag.pubads());

  googletag.pubads().enableSingleRequest();
  googletag.pubads().disableInitialLoad();

  googletag.enableServices();
});

var nextSlotId = 1;
function generateNextSlotId() {
	return nextSlotId++;
}
// ===========================================
// ここまでHEADタグ
// ===========================================
</script>


<script>
// ===========================================
// ここから追加コンテンツロード
// ===========================================
function moreContent() {
    // ===========================================
    // 絶対必要 START
    // ===========================================
	var slotDiv = '';
	var slot_id = generateNextSlotId();
   // ===========================================
   // 最後に絶対必要 END
   // ===========================================


   // ===========================================
   // コンテンツ1
   // ===========================================
   var h1=document.createElement("H2")
   var text1=document.createTextNode("仮のダイナミック コンテンツ 1");
   h1.appendChild(text1);
   document.body.appendChild(h1);

   // 記事下広告を配信する場所に設置 START
   slotDiv = document.createElement('div');
   slotDiv.id = "kijisita_" + slot_id
   document.body.appendChild(slotDiv);
   // 記事下広告を配信する場所に設置 END

   // ===========================================
   // コンテンツ2
   // ===========================================
   var h2=document.createElement("H2")
   var text2=document.createTextNode("仮のダイナミック コンテンツ 2");
   h2.appendChild(text2);
   document.body.appendChild(h2);

	// ミドル1st広告を配信する場所に設置 START
	slotDiv = document.createElement('div');
	slotDiv.id = "middle_1st_" + slot_id
	document.body.appendChild(slotDiv);
	// ミドル1st広告を配信する場所に設置 EN

   // ===========================================
   // 最後に絶対必要 START
   // ===========================================
   googletag.cmd.push(function() {
		var slot_name = '';
		var slot = '';

		slot_name = 'kijisita_' + slot_id;
		slot = googletag.defineSlot('/62532913/s_mamari_320x100_kijisita_9999', [320, 100], slot_name).
		addService(googletag.pubads());
		googletag.display(slot_name);
		googletag.pubads().refresh([slot]);

		slot_name = 'middle_1st_' + slot_id;
		slot = googletag.defineSlot('/62532913/s_mamari_300x250_middle1starticle_9999', [300, 250], slot_name).
		addService(googletag.pubads());
		googletag.display(slot_name);
		googletag.pubads().refresh([slot]);
   });
 }
</script>

</head>

<body>
 <h1>mamari.jp様テストページ</h1>

 <!-- 最初の仮のコンテンツ -->
 <text>
 <h2>最初の仮のコンテンツ</h2>
 </text>

 <!-- 最初の広告 -->
 <p>記事下広告</p>
 <div id="kijisita_0"> 
     <script>
        // display() を呼び出してスロットを準備完了として登録し、
        // refresh() を呼び出して広告を取得
        googletag.cmd.push(function() {
        googletag.display('kijisita_0');
        googletag.pubads().refresh();
        });
     </script> 
 </div>

 <text>
  <h2>続きのコンテンツ</h2>
 </text>

 <p>ミドル1st広告</p>
 <div id="middle_1st_0"> 
     <script>
        // display() を呼び出してスロットを準備完了として登録し、
        // refresh() を呼び出して広告を取得
        googletag.cmd.push(function() {
        googletag.display('middle_1st_0');
        googletag.pubads().refresh();
        });
     </script> 
 </div>

 <!-- 追加コンテンツを動的に読み込むボタン -->
 <button onclick="moreContent()">下まで見たとすると・・・</button>

</body>
</html>

